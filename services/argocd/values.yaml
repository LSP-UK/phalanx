# The following will be set by parameters injected by Argo CD and should not
# be set in the individual environment values files.
global:
  # -- Base URL for the environment
  # @default -- Set by Argo CD
  baseUrl: ""

  # -- Host name for ingress
  # @default -- Set by Argo CD
  host: ""

  # -- Base path for Vault secrets
  # @default -- Set by Argo CD
  vaultSecretsPath: ""

argo-cd:
  redis:
    enabled: true
    metrics:
      enabled: true

  controller:
    metrics:
      enabled: true
      applicationLabels:
        enabled: true
        labels: ["name", "instance"]

  repoServer:
    metrics:
      enabled: true

  notifications:
    metrics:
      enabled: true

  server:
    metrics:
      enabled: true
    ingress:
      enabled: true
      hosts:
        - {{ required "global.host must be set" .Values.global.host | quote }}
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/rewrite-target: "/$2"
      paths:
        - /argo-cd(/|$)(.*)

    extraArgs:
      - "--basehref=/argo-cd"
      - "--insecure=true"

  config:
    url: "{{ .Values.global.baseUrl }}/argo-cd"

  configs:
    secret:
      createSecret: false

pull-secret:
  enabled: true
  path: "{{ .global.vaultSecretsPath }}/pull-secret"
